# TestBox Apps 模块概览

`apps/` 目录承载 TestBox 微服务的运行编排逻辑，负责将领域模型、驱动和传输层组装为可运行的 Actor 管道。

## 结构

- `__init__.py`：对外暴露 Actor、Runtime 以及 CLI 帮助方法。
- `actor.py`：核心 Actor 循环，消费命令、调度驱动、产出遥测或错误事件。
- `queues.py`：命令队列与遥测队列的 asyncio 封装，统一消息类型。
- `main.py`：命令行入口，提供 demo 与 MQTT 两种运行模式，并完成配置解析、适配器装配与心跳挂载。
- `hb.py`：心跳与 MQTT 遗嘱工具，负责周期性心跳发布与 Last Will 配置。

## 关键职责

- **Actor**：读取命令队列、调用驱动、产出进度/完成事件，同时捕获异常并转换为 `ErrorEvent`。
- **队列**：在 Actor 与 MQTT 适配器之间做缓冲，支持 backpressure 与异步解耦。
- **入口**：统一处理配置与运行模式，同时装配心跳、命令/遥测适配器，保证测试、CLI、部署阶段都能重用相同流程。

## 开发约定

- 异步循环需支持 `stop()`，以便 CLI 和测试能够优雅退出。
- 新增入口模式优先收敛在 `main.py`，保持调用一致性。
- 配置字典交由 `create_actor` 统一处理，方便在不同模式间复用；心跳、串口等参数通过 config 注入。
